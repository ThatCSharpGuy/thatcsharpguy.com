<!DOCTYPE html>
<html lang="es"  itemscope itemtype="http://schema.org/Blog">
<head>
        <!–– Made with Lockdown: https://github.com/fferegrino/lockdown ––>
  
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-translate-customization" content="108d9124921d80c3-80e20d618ff053c8-g4f02ec6f3dba68b7-c"></meta>

  <link rel="shortcut icon" href="">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-noto-sans@0.0.72/index.min.css">
  <link rel="stylesheet" href="/css/main.css">
  <script src="/js/main.js"></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/vs.min.css" integrity="sha512-aWjgJTbdG4imzxTxistV5TVNffcYGtIQQm2NBNahV6LmX14Xq9WwZTL1wPjaSglUuVzYgwrq+0EuI4+vKvQHHw==" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js" integrity="sha512-9GIHU4rPKUMvNOHFOer5Zm2zHnZOjayOO3lZpokhhCtgt8FNlNiW/bb7kl0R5ZXfCDVPcQ8S4oBdNs92p5Nm2w==" crossorigin="anonymous"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script data-ad-client="ca-pub-9566151416325480" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#2176ff">
<meta name="msapplication-TileColor" content="#eeeef2">
<meta name="theme-color" content="#eeeef2">


<title>Xamarin.Forms, anatomía de una app | That C# guy</title>

<!-- Search Engine -->
<meta name="description" content="Las partes que componen una aplicación hecha con Forms son dos&ellip; el núcleo o shared code y los proyectos clientes móviles que consumen dicho núcleo.">
<meta name="image" content="">
<!-- Schema.org for Google -->
<meta itemprop="name" content="Xamarin.Forms, anatomía de una app">
<meta itemprop="description" content="Las partes que componen una aplicación hecha con Forms son dos&ellip; el núcleo o shared code y los proyectos clientes móviles que consumen dicho núcleo.">
<meta itemprop="image" content="">
<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Xamarin.Forms, anatomía de una app">
<meta name="twitter:description" content="Las partes que componen una aplicación hecha con Forms son dos&ellip; el núcleo o shared code y los proyectos clientes móviles que consumen dicho núcleo.">
<meta name="twitter:site" content="@io_exception">
<meta name="twitter:creator" content="@io_exception">
<meta name="twitter:image" content="">
<!-- Open Graph general (Facebook, Pinterest & Google+) -->
<meta name="og:title" content="Xamarin.Forms, anatomía de una app">
<meta name="og:description" content="Las partes que componen una aplicación hecha con Forms son dos&ellip; el núcleo o shared code y los proyectos clientes móviles que consumen dicho núcleo.">
<meta name="og:image" content="">
<meta name="og:url" content="https://thatcsharpguy.com/">
<meta name="og:site_name" content="That C# guy">
<meta name="og:locale" content="es">
<meta name="og:type" content="website">


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GPXCSH21CP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-GPXCSH21CP');
</script>

        
</head>

<body style="position: relative; min-height: 100%; top: 0px;">  
        <header class="site-header " role="banner">
  <div class="wrapper">
     <div class="site-header-inner">
       <span class="site-brand">
         <a class="site-brand-inner" rel="author" href="/">
          <!-- <img class="site-favicon" title="Your awesome title" src="" onerror="this.style.display='none'"> -->
          That C# guy
        </a>
      </span>
        <nav class="site-nav">
           <input type="checkbox" id="nav-trigger" class="nav-trigger">
           <label for="nav-trigger">
              <span class="menu-icon">
                 <svg viewbox="0 0 18 15" width="18px" height="15px">
                    <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
                 </svg>
              </span>
           </label>
           <div class="trigger">
             <!-- Header links -->
              <a class="page-link" target="_blank" href="https://www.youtube.com/thatcsharpguy/">YOUTUBE</a>
              <span class="page-link">
    <div id="google_translate_element" style="display: none;"></div>
    <span class="ct-language">
       <ul class="list-unstyled ct-language-dropdown">
         <li>
            <a href="#" class="lang-select" data-lang="es">
            <img src="https://www.countryflags.io/mx/flat/64.png" title="México">
            </a>
         </li>
          <li>
             <a href="#" class="lang-select" data-lang="en">
             <img src="https://www.countryflags.io/gb/flat/64.png" title="English">
             </a>
          </li>
          <li>
             <a href="#" class="lang-select" data-lang="fr">
             <img src="https://www.countryflags.io/fr/flat/64.png" title="Franch">
             </a>
          </li>
          <li>
             <a href="#" class="lang-select" data-lang="zh-CN">
             <img src="https://www.countryflags.io/cn/flat/64.png" title="Chinese(Simple)">
             </a>
          </li>
          <li>
             <a href="#" class="lang-select" data-lang="ja">
             <img src="https://www.countryflags.io/jp/flat/64.png" title="Japan">
             </a>
          </li>
          <li>
             <a href="#" class="lang-select" data-lang="ko">
             <img src="https://www.countryflags.io/kr/flat/64.png" title="Korean">
             </a>
          </li>
          <li>
             <a href="#" class="lang-select" data-lang="ru">
             <img src="https://www.countryflags.io/ru/flat/64.png" title="Russia">
             </a>
          </li>
       </ul>
    </span>
    <script type="text/javascript">
       function googleTranslateElementInit() {
         new google.translate.TranslateElement({
           pageLanguage: '',
           autoDisplay: false,
           layout: google.translate.TranslateElement.InlineLayout.VERTICAL
         }, 'google_translate_element');
       
         function restoreLang() {
           var iframe = document.getElementsByClassName('goog-te-banner-frame')[0];
           if (!iframe) return;
       
           var innerDoc = iframe.contentDocument || iframe.contentWindow.document;
           var restore_el = innerDoc.getElementsByTagName("button");
       
           for (var i = 0; i < restore_el.length; i++) {
             if (restore_el[i].id.indexOf("restore") >= 0) {
               restore_el[i].click();
               var close_el = innerDoc.getElementsByClassName("goog-close-link");
               close_el[0].click();
               return;
             }
           }
         }
       
         function triggerHtmlEvent(element, eventName) {
           var event;
           if (document.createEvent) {
             event = document.createEvent('HTMLEvents');
             event.initEvent(eventName, true, true);
             element.dispatchEvent(event);
           } else {
             event = document.createEventObject();
             event.eventType = eventName;
             element.fireEvent('on' + event.eventType, event);
           }
         }
       
         var googleCombo = document.querySelector("select.goog-te-combo");
         var langSelect = document.querySelector('.ct-language');
         langSelect.addEventListener('click', function(event) {
           if (!event.target) {
             return;
           }
       
           var selected = document.querySelector('.ct-language .ct-language-selected');
           if (selected) {
             selected.classList.remove('ct-language-selected');
           }
       
           var target = event.target;
           while (target && target !== langSelect ) {
             if (target.matches('.lang-select')) {
               break;
             }
             target = target.parentElement;
           }
       
           if (target && target.matches('.lang-select')) {
             var lang = target.getAttribute('data-lang');
             if (lang == "es") {
               restoreLang();
             } else {
               target.parentElement.classList.add('ct-language-selected');
               googleCombo.value = lang;
               triggerHtmlEvent(googleCombo, 'change');
             }
           }
       
           event.preventDefault();
         });
       }
    </script>
    <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
 </span>
           </div>
        </nav>
     </div>
  </div>
</header>
<script>
  (function() {
    var lastScrollY = getScrollPos().y;
    var documentElement = document.documentElement;

    function storeScrollData() {
      var y = getScrollPos().y;

      documentElement.setAttribute("data-header-transparent", "");

      var scrollStatus = "";
      if (y <= 0) {
        scrollStatus = "top";
      } else if ((window.innerHeight + y) >= document.body.offsetHeight) {
        scrollStatus = "bottom";
      } else {
        var isScrollDown = (y - lastScrollY > 0) ? true : false;
        scrollStatus = isScrollDown ? "down" : "up";
      }
      lastScrollY = y;
      documentElement.setAttribute("data-scroll-status", scrollStatus);
    }
    window.addEventListener('scroll', function(e) {
      storeScrollData();
    });
    storeScrollData();
  })();
</script>
          
        

        <div class="theme-toggle">
    <input type="checkbox" id="theme-switch">
    <label for="theme-switch">
      <div class="toggle"></div>
      <div class="names">
        <p class="light">Light</p>
        <p class="dark">Dark</p>
      </div>
    </label>
  </div>
  
  
  <script>
    (function() {
      var sw = document.getElementById('theme-switch');
      var html = document.getElementsByTagName('html')[0];
      var nightModeOption = ('auto' || 'auto').toLowerCase();
      var storage = nightModeOption === 'manual'
          ? localStorage
          : sessionStorage;
      var themeData = loadThemeData();
  
      function saveThemeData(data) {
        storage.setItem('theme', JSON.stringify(data));
      }
  
      function loadThemeData() {
        var data = storage.getItem('theme');
        try {
          data = JSON.parse(data ? data : '');
        } catch(e) {
          data = { nightShift: undefined, autoToggleAt: 0 };
          saveThemeData(data);
        }
        return data;
      }
  
      function handleThemeToggle(nightShift) {
        themeData.nightShift = nightShift;
        saveThemeData(themeData);
        html.dataset.theme = nightShift ? 'dark' : 'light';
        setTimeout(function() {
          sw.checked = nightShift ? true : false;
        }, 50);
      }
  
      function autoThemeToggle() {
        // Next time point of theme toggle
        var now = new Date();
        var toggleAt = new Date();
        var hours = now.getHours();
        var nightShift = hours >= 19 || hours <=7;
  
        if (nightShift) {
          if (hours > 7) {
            toggleAt.setDate(toggleAt.getDate() + 1);
          }
          toggleAt.setHours(7);
        } else {
          toggleAt.setHours(19);
        }
  
        toggleAt.setMinutes(0);
        toggleAt.setSeconds(0);
        toggleAt.setMilliseconds(0)
  
        var delay = toggleAt.getTime() - now.getTime();
  
        // auto toggle theme mode
        setTimeout(function() {
          handleThemeToggle(!nightShift);
        }, delay);
  
        return {
          nightShift: nightShift,
          toggleAt: toggleAt.getTime()
        };
      }
  
      // Listen the theme toggle event
      sw.addEventListener('change', function(event) {
        handleThemeToggle(event.target.checked);
      });
  
      if (nightModeOption == 'auto') {
        var data = autoThemeToggle();
  
        // Toggle theme by local setting
        if (data.toggleAt > themeData.autoToggleAt) {
          themeData.autoToggleAt = data.toggleAt;
          handleThemeToggle(data.nightShift);
        } else {
          handleThemeToggle(themeData.nightShift);
        }
      } else if (nightModeOption == 'manual') {
        handleThemeToggle(themeData.nightShift);
      } else {
        var nightShift = themeData.nightShift;
        if (nightShift === undefined) {
          nightShift = nightModeOption === 'on';
        }
        handleThemeToggle(nightShift);
      }
    })();
  </script>

        <div class="page-content">
            <div class="wrapper">
                <div class="framework">
                    <section class="main">
                
<h1>Xamarin.Forms, anatomía de una app</h1>

<div class="video-wrapper">
<iframe src='https://onedrive.live.com/embed?cid=05D7523CBBAF0419&resid=5D7523CBBAF0419%21128893&authkey=AIJIECFXvuJszW0&em=2&wdAr=1.7777777777777777' width='350px' height='221px' frameborder='0'>Esto es un documento de <a target='_blank' href='https://office.com'>Microsoft Office</a> incrustado con tecnología de <a target='_blank' href='https://office.com/webapps'>Office Online</a>.</iframe>
</div>
 
<br />
<p>En el blog he hablado mucho de Xamarin.Forms, pero nunca he explicado cómo es que funciona una app hecha con Forms... pues bien, en este post lo explico. Para este post estaré usando la aplicación <a href="../mvvm-xamarin-forms" target="_blank" rel="nofollow">Mvvmdex que expliqué en un post pasado</a>.</p>
<p>Comenzando por la estructura en componentes de la aplicación, en el siguiente diagrama se muestra a grandes rasgos las partes que componen una aplicación hecha con Forms, en el diagrama podrás ver que una app se compone de dos tipos de proyecto: el núcleo (en el diagrama tiene la etiqueta <em>Shared Code</em>) y los clientes (iOS, Android y UWP):</p>
<img src="https://thatcsharpguy.github.io/postimages/xamarin-forms/arch/main.png" title="Arquitectura" />
<h2>Núcleo</h2>
<p>En el núcleo es en donde ocurre la mayor parte del trabajo en una app con Forms ya que contiene gran parte de lo que la hace funcionar, incluyendo la interfaz gráfica. Es importante señalar que el hecho de que en el diagrama esté todo agrupado, no necesariamente tiene que ser así, podemos dividir el núcleo en tantos proyectos como sea necesario y conveniente para nuestro desarrollo. Por ejemplo, en mi app Mvvmdex, el núcleo está dividido en tres: Models, ViewModels y Views:</p>
<img src="https://thatcsharpguy.github.io/postimages/xamarin-forms/arch/full.png" title="Arquitectura" />
<p>Este tipo de proyecto es usualmente una <a href="../que-son-portable-class-library" target="_blank" rel="nofollow">librería de clases portable</a>, aunque también puede ser un proyecto compartido. Sin importar qué tipo de proyecto sea, debes tener en cuenta las partes fundamentales en el código del núcleo, las cuales son:</p>
<ul>
<li><p>Que exista una clase derivada de <code>Xamarin.Forms.Application</code>. En el caso de la Mvvmdex esta se encuentra en el archivo <code>App.xaml.cs</code>. Esta clase puede ser de solo código o depender de un archivo Xaml asociado.</p>
</li>
<li><p>Dentro del constructor de dicha clase establecer la página inicial de nuestra aplicación a través de la propiedad <code>MainPage</code><br />
En el template por default la página es creada directamente en el constructor, en mi app, la pagina principal está en un archivo separado.</p>
</li>
</ul>
<p>Así es como se ve en el sistema de archivos y en el explorador de soluciones:</p>
<div class="pure-g">
<div class="pure-u-1 pure-u-md-1-2">
<img src="https://thatcsharpguy.github.io/postimages/xamarin-forms/arch/xf-files.jpg" title=""Xamarin.Forms en sistema de archivos"" />
</div>
<div class="pure-u-1 pure-u-md-1-2">
<img src="https://thatcsharpguy.github.io/postimages/xamarin-forms/arch/views.png" title=""Xamarin.Forms en el explorador de soluciones"" />
</div>  
</div>
<h2>Clientes</h2>
<p>Los proyectos clientes son aquellos que &quot;consumen&quot; el núcleo, estos tienden a requerir menos trabajo ya que su expresión más sencilla, su única labor es cargar el núcleo usando código específico de la plataforma. En general la forma de ejecutar la aplicación es similar en todas las plataformas soportadas (Android, iOS y Windows): Primero se carga el inicializa el mecanismo de Xamarin.Forms y después se carga el núcleo de nuestra app. A continuación los detalles:</p>
<h3>iOS</h3>
<p>En iOS hay tres tareas a realizar:</p>
<ul>
<li>Que nuestro <code>AppDelegate</code> derive de <code>FormsApplicationDelegate</code></li>
<li>Inicializar Forms llamando a <code>Forms.Init();</code>, esto debe ser en el método sobreescrito <code>FinishedLaunching</code></li>
<li>Finalmente se carga la aplicación con el método <code>LoadApplication</code>, pasándole como parámetro una instancia de nuestra <code>App</code></li>
</ul>
<p>Así es como se ve en el sistema de archivos y en el explorador de soluciones:</p>
<div class="pure-g">
<div class="pure-u-1 pure-u-md-1-2">
<img src="https://thatcsharpguy.github.io/postimages/xamarin-forms/arch/ios-files.jpg" title="iOS en sistema de archivos" />
</div>
<div class="pure-u-1 pure-u-md-1-2">
<img src="https://thatcsharpguy.github.io/postimages/xamarin-forms/arch/ios.png" title="iOS en el explorador de soluciones" />
</div>  
</div>  
  
### Android  
<p>En esta plataforma de igual manera son tres tareas:</p>
<ul>
<li>Que la &quot;<code>MainActivity</code>&quot; derive de <code>FormsAppCompatActivity</code> (o de <code>FormsApplicationActivity</code>)</li>
<li>Inicializar Forms con <code>Forms.Init(this, bundle);</code>, pasandole como parámetros la <em>activity</em> en cuestión y su <em>bundle</em>, la inicialización debe suceder en el método <code>OnCreate</code></li>
<li>Finalmente se carga la aplicación con el método <code>LoadApplication</code>, pasándole como parámetro una instancia de nuestra <code>App</code></li>
</ul>
<p>Así es como se ve en el sistema de archivos y en el explorador de soluciones:</p>
<div class="pure-g">
<div class="pure-u-1 pure-u-md-1-2">
<img src="https://thatcsharpguy.github.io/postimages/xamarin-forms/arch/android-files.jpg" title="Android en sistema de archivos" />
</div>
<div class="pure-u-1 pure-u-md-1-2">
<img src="https://thatcsharpguy.github.io/postimages/xamarin-forms/arch/droid.png" title="Android en el explorador de soluciones" />
</div>  
</div>  
  
### Windows  
<p>Trabajar con Windows es un poco &quot;complicado&quot;, ya que requiere modificar dos archivos:</p>
<ul>
<li>En la clase <code>App</code> del proyecto de Windows inicializar Forms con <code>Forms.Init(e);</code>, es importante pasarle los argumentos del método como parámetros. Esto debe ocurrir dentro del método <code>OnLaunched</code>.</li>
<li>Ahora, en el archivo <code>MainPage.xaml</code>, debemos cambiar el tipo de la página de <code>Page</code> a <code>WindowsPage</code>, para esto es necesario añadir un <em>xml namespace</em></li>
<li>Finalmente, como con los anteriores, se carga la aplicación con el método <code>LoadApplication</code> (pasándole como parámetro una instancia de nuestra <code>App</code>) dentro del constructor de la <code>MainPage</code></li>
</ul>
<p>Así es como se ve en el sistema de archivos y en el explorador de soluciones:</p>
<div class="pure-g">
<div class="pure-u-1 pure-u-md-1-2">
<img src="https://thatcsharpguy.github.io/postimages/xamarin-forms/arch/uwp-files.jpg" title="Windows en sistema de archivos" />
</div>
<div class="pure-u-1 pure-u-md-1-2">
<img src="https://thatcsharpguy.github.io/postimages/xamarin-forms/arch/uwp.jpg" title="Windows en el explorador de soluciones" />
</div>  
</div>  
   
## Conclusión  
<p>Tal vez esto podrá parecerte muy... innecesario, ya que los templates que trae Xamarin hacen esta tarea por nosotros, sin embargo, yo creo que nunca está de más saber cómo es que funcionan las cosas, además de que tu aplicación exija que este proceso de ejecución de la aplicación se realice de una manera distinta a la forma por default de Xamarin.Forms, por ejemplo <a href="../opening-files-xamarin-forms">para recibir archivos</a> en una aplicación.</p>



                    </section>
                    <section class="sidebar">
                    <div class="post-menu">
                        <div class="post-menu-title">Sígueme en</div>
                        <div class="common-list">
                            <ul>
                            
                                <li>
                                    <a href="https://github.com/fferegrino">
                                    GitHub<span> <i class="fa fa-github"></i> </span>
                                    </a>
                                </li>
                            
                                <li>
                                    <a href="https://twitter.com/io_exception">
                                    Twitter<span> <i class="fa fa-twitter"></i> </span>
                                    </a>
                                </li>
                            
                                <li>
                                    <a href="https://twitter.com/io_exception">
                                    YouTube<span> <i class="fa fa-youtube"></i> </span>
                                    </a>
                                </li>
                            
                                <li>
                                    <a href="https://tcsg.dev/discord">
                                    Discord<span> <i class="fa fa-discord"></i> </span>
                                    </a>
                                </li>
                            
                            </ul>
                        </div>
                    </div>
                    
                    
                    </section>
                </div>
            </div>
        </div>
        <footer class="site-footer h-card">
   <data class="u-url" href="/"></data>
 
   <div class="wrapper">
     <div class="site-footer-inner">
       <div> </div>
       <div>Powered by <a title="Lockdonw in a simple, blog-aware, static site generator." href="https://github.com/lockdownblog/lockdown">Lockdown</a> &amp; <a title="Yat, yetanother theme." href="https://github.com/jeffreytse/jekyll-theme-yat">Yat Theme</a>.</div>
       <!-- <div class="footer-col rss-subscribe">Subscribe <a href="/feed.xml">via RSS</a></div> -->
     </div>
   </div>
 </footer>
</body>
</html>
