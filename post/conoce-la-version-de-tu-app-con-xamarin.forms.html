<!DOCTYPE html>
<html lang="es" itemscope itemtype="http://schema.org/Blog">
    <head>
        <!–– Made with Lockdown: https://github.com/fferegrino/lockdown ––>
  
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-translate-customization" content="108d9124921d80c3-80e20d618ff053c8-g4f02ec6f3dba68b7-c"></meta>

  <link rel="shortcut icon" href="">
  <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->
  <script src="https://kit.fontawesome.com/0271495296.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-noto-sans@0.0.72/index.min.css">
  <link rel="stylesheet" href="/css/main.css">
  <script src="/js/main.js"></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/vs.min.css" integrity="sha512-aWjgJTbdG4imzxTxistV5TVNffcYGtIQQm2NBNahV6LmX14Xq9WwZTL1wPjaSglUuVzYgwrq+0EuI4+vKvQHHw==" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js" integrity="sha512-9GIHU4rPKUMvNOHFOer5Zm2zHnZOjayOO3lZpokhhCtgt8FNlNiW/bb7kl0R5ZXfCDVPcQ8S4oBdNs92p5Nm2w==" crossorigin="anonymous"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script data-ad-client="ca-pub-9566151416325480" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#2176ff">
<meta name="msapplication-TileColor" content="#eeeef2">
<meta name="theme-color" content="#eeeef2">


  <title>Conoce la versión de tu app con Xamarin.Forms | That C# guy</title>

  <!-- Search Engine -->
  <meta name="description" content="El asignarle un código de versión a cada una de las actualizaciones de tu app es de vital importancia, te ayudará a tener un punto de referencia cuando tengas que resolver algún bug o recolectar información para analizar el desempeño de tus apps.">
  <meta name="image" content="">
  <!-- Schema.org for Google -->
  <meta itemprop="name" content="Conoce la versión de tu app con Xamarin.Forms">
  <meta itemprop="description" content="El asignarle un código de versión a cada una de las actualizaciones de tu app es de vital importancia, te ayudará a tener un punto de referencia cuando tengas que resolver algún bug o recolectar información para analizar el desempeño de tus apps.">
  <meta itemprop="image" content="">
  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Conoce la versión de tu app con Xamarin.Forms">
  <meta name="twitter:description" content="El asignarle un código de versión a cada una de las actualizaciones de tu app es de vital importancia, te ayudará a tener un punto de referencia cuando tengas que resolver algún bug o recolectar información para analizar el desempeño de tus apps.">
  <meta name="twitter:site" content="@io_exception">
  <meta name="twitter:creator" content="@io_exception">
  <meta name="twitter:image" content="">
  <!-- Open Graph general (Facebook, Pinterest & Google+) -->
  <meta name="og:title" content="Conoce la versión de tu app con Xamarin.Forms">
  <meta name="og:description" content="El asignarle un código de versión a cada una de las actualizaciones de tu app es de vital importancia, te ayudará a tener un punto de referencia cuando tengas que resolver algún bug o recolectar información para analizar el desempeño de tus apps.">
  <meta name="og:image" content="">
  <meta name="og:url" content="https://thatcsharpguy.com/">
  <meta name="og:site_name" content="That C# guy">
  <meta name="og:locale" content="es">
  <meta name="og:type" content="website">


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GPXCSH21CP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-GPXCSH21CP');
</script>

        
    </head>
    <body style="position: relative; min-height: 100%; top: 0px;">
        <header class="site-header " role="banner">
  <div class="wrapper">
     <div class="site-header-inner">
       <span class="site-brand">
         <a class="site-brand-inner" rel="author" href="/">
          <!-- <img class="site-favicon" title="Your awesome title" src="" onerror="this.style.display='none'"> -->
          That C# guy
        </a>
      </span>
        <nav class="site-nav">
           <input type="checkbox" id="nav-trigger" class="nav-trigger">
           <label for="nav-trigger">
              <span class="menu-icon">
                 <svg viewbox="0 0 18 15" width="18px" height="15px">
                    <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
                 </svg>
              </span>
           </label>
           <div class="trigger">
             <!-- Header links -->
              <a class="page-link" target="_blank" href="https://www.youtube.com/thatcsharpguy/">YOUTUBE</a>
              <span class="page-link">
    <div id="google_translate_element" style="display: none;"></div>
    <span class="ct-language">
       <ul class="list-unstyled ct-language-dropdown">
         <li>
            <a href="#" class="lang-select" data-lang="es">
            <img src="https://www.countryflags.io/mx/flat/64.png" title="México">
            </a>
         </li>
          <li>
             <a href="#" class="lang-select" data-lang="en">
             <img src="https://www.countryflags.io/gb/flat/64.png" title="English">
             </a>
          </li>
          <li>
             <a href="#" class="lang-select" data-lang="fr">
             <img src="https://www.countryflags.io/fr/flat/64.png" title="Franch">
             </a>
          </li>
          <li>
             <a href="#" class="lang-select" data-lang="zh-CN">
             <img src="https://www.countryflags.io/cn/flat/64.png" title="Chinese(Simple)">
             </a>
          </li>
          <li>
             <a href="#" class="lang-select" data-lang="ja">
             <img src="https://www.countryflags.io/jp/flat/64.png" title="Japan">
             </a>
          </li>
          <li>
             <a href="#" class="lang-select" data-lang="ko">
             <img src="https://www.countryflags.io/kr/flat/64.png" title="Korean">
             </a>
          </li>
          <li>
             <a href="#" class="lang-select" data-lang="ru">
             <img src="https://www.countryflags.io/ru/flat/64.png" title="Russia">
             </a>
          </li>
       </ul>
    </span>
    <script type="text/javascript">
       function googleTranslateElementInit() {
         new google.translate.TranslateElement({
           pageLanguage: '',
           autoDisplay: false,
           layout: google.translate.TranslateElement.InlineLayout.VERTICAL
         }, 'google_translate_element');
       
         function restoreLang() {
           var iframe = document.getElementsByClassName('goog-te-banner-frame')[0];
           if (!iframe) return;
       
           var innerDoc = iframe.contentDocument || iframe.contentWindow.document;
           var restore_el = innerDoc.getElementsByTagName("button");
       
           for (var i = 0; i < restore_el.length; i++) {
             if (restore_el[i].id.indexOf("restore") >= 0) {
               restore_el[i].click();
               var close_el = innerDoc.getElementsByClassName("goog-close-link");
               close_el[0].click();
               return;
             }
           }
         }
       
         function triggerHtmlEvent(element, eventName) {
           var event;
           if (document.createEvent) {
             event = document.createEvent('HTMLEvents');
             event.initEvent(eventName, true, true);
             element.dispatchEvent(event);
           } else {
             event = document.createEventObject();
             event.eventType = eventName;
             element.fireEvent('on' + event.eventType, event);
           }
         }
       
         var googleCombo = document.querySelector("select.goog-te-combo");
         var langSelect = document.querySelector('.ct-language');
         langSelect.addEventListener('click', function(event) {
           if (!event.target) {
             return;
           }
       
           var selected = document.querySelector('.ct-language .ct-language-selected');
           if (selected) {
             selected.classList.remove('ct-language-selected');
           }
       
           var target = event.target;
           while (target && target !== langSelect ) {
             if (target.matches('.lang-select')) {
               break;
             }
             target = target.parentElement;
           }
       
           if (target && target.matches('.lang-select')) {
             var lang = target.getAttribute('data-lang');
             if (lang == "es") {
               restoreLang();
             } else {
               target.parentElement.classList.add('ct-language-selected');
               googleCombo.value = lang;
               triggerHtmlEvent(googleCombo, 'change');
             }
           }
       
           event.preventDefault();
         });
       }
    </script>
    <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
 </span>
           </div>
        </nav>
     </div>
  </div>
</header>
<script>
  (function() {
    var lastScrollY = getScrollPos().y;
    var documentElement = document.documentElement;

    function storeScrollData() {
      var y = getScrollPos().y;

      documentElement.setAttribute("data-header-transparent", "");

      var scrollStatus = "";
      if (y <= 0) {
        scrollStatus = "top";
      } else if ((window.innerHeight + y) >= document.body.offsetHeight) {
        scrollStatus = "bottom";
      } else {
        var isScrollDown = (y - lastScrollY > 0) ? true : false;
        scrollStatus = isScrollDown ? "down" : "up";
      }
      lastScrollY = y;
      documentElement.setAttribute("data-scroll-status", scrollStatus);
    }
    window.addEventListener('scroll', function(e) {
      storeScrollData();
    });
    storeScrollData();
  })();
</script>
        
        <div class="theme-toggle">
  <input type="checkbox" id="theme-switch"/>
  <label for="theme-switch">
      <div class="toggle"></div>
      <div class="names">
          <p class="light">Light</p>
          <p class="dark">Dark</p>
      </div>
  </label>
</div>
  


<script>
    (function() {
      var sw = document.getElementById('theme-switch');
      var html = document.getElementsByTagName('html')[0];
      var nightModeOption = ('auto' || 'auto').toLowerCase();
      var storage = nightModeOption === 'manual'
          ? localStorage
          : sessionStorage;
      var themeData = loadThemeData();
  
      function saveThemeData(data) {
        storage.setItem('theme', JSON.stringify(data));
      }
  
      function loadThemeData() {
        var data = storage.getItem('theme');
        try {
          data = JSON.parse(data ? data : '');
        } catch(e) {
          data = { nightShift: undefined, autoToggleAt: 0 };
          saveThemeData(data);
        }
        return data;
      }
  
      function handleThemeToggle(nightShift) {
        themeData.nightShift = nightShift;
        saveThemeData(themeData);
        html.dataset.theme = nightShift ? 'dark' : 'light';
        setTimeout(function() {
          sw.checked = nightShift ? true : false;
        }, 50);
      }
  
      function autoThemeToggle() {
        // Next time point of theme toggle
        var now = new Date();
        var toggleAt = new Date();
        var hours = now.getHours();
        var nightShift = hours >= 19 || hours <=7;
  
        if (nightShift) {
          if (hours > 7) {
            toggleAt.setDate(toggleAt.getDate() + 1);
          }
          toggleAt.setHours(7);
        } else {
          toggleAt.setHours(19);
        }
  
        toggleAt.setMinutes(0);
        toggleAt.setSeconds(0);
        toggleAt.setMilliseconds(0)
  
        var delay = toggleAt.getTime() - now.getTime();
  
        // auto toggle theme mode
        setTimeout(function() {
          handleThemeToggle(!nightShift);
        }, delay);
  
        return {
          nightShift: nightShift,
          toggleAt: toggleAt.getTime()
        };
      }
  
      // Listen the theme toggle event
      sw.addEventListener('change', function(event) {
        handleThemeToggle(event.target.checked);
      });
  
      if (nightModeOption == 'auto') {
        var data = autoThemeToggle();
  
        // Toggle theme by local setting
        if (data.toggleAt > themeData.autoToggleAt) {
          themeData.autoToggleAt = data.toggleAt;
          handleThemeToggle(data.nightShift);
        } else {
          handleThemeToggle(themeData.nightShift);
        }
      } else if (nightModeOption == 'manual') {
        handleThemeToggle(themeData.nightShift);
      } else {
        var nightShift = themeData.nightShift;
        if (nightShift === undefined) {
          nightShift = nightModeOption === 'on';
        }
        handleThemeToggle(nightShift);
      }
    })();
  </script>
        <div class="page-content">
            <div class="wrapper">
                <div class="framework">
                    <section class="main"> 
                        
<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
    <div class="post-content e-content" itemprop="articleBody">
        <h1>Conoce la versión de tu app con Xamarin.Forms</h1>
        
<p>Y tu, ¿cómo versionas tus apps? El asignarle una versión a cada publicación de una app suele ser muy importante para cuando tenemos que resolver algún bug y le solicitamos directamente al usuario que nos indique qué versión de la app está ejecutando. También resulta útil si llevamos a cabo alguna especie de análisis de qué versiones de nuestras apps son más utilizadas e inclusive poder indicarle al usuario que la versión de la app que está ejecutando no es la más reciente.</p>
<p>Android e iOS hacen muy sencilla la tarea de asignarle una versión a cada publicación que hacemos de alguna aplicación:</p>
<h2 id="android">Android</h2>
<p>En Android existen dos valores que nos sirven para establecer la versión de nuestra app, uno es público y visible para el usuario mientras que el otro es privado y disponible únicamente para nosotros y la tienda de aplicaciones.</p>
<p>Estos dos valores son:</p>
<ul>
<li><p><code>android:versionCode</code> es el valor &quot;privado&quot;. El propósito de este número es el de indicar al desarrollador (y a la tienda) que una versión de una app es más reciente que otra. Este valor es siempre un entero, así que puedes usar cualquier sistema de versionamiento que desees, siempre y cuando al momento de publicar una actualización de tu app, el valor del nuevo <code>apk</code> sea mayor al que ya existía en la tienda. Toma en cuenta que el valor máximo es 2,100,000,000; así que si pensabas tener dos mil millones de actualizaciones de tu app... tal vez Android no es para ti.</p>
</li>
<li><p><code>android:versionName</code> es el valor que los usuarios ven en la tienda de aplicaciones, en teoría puede ser cualquier cadena de caracteres... aunque no es así. Lo recomendable es usar números y <code>.</code>, combinados en una nomenclatura clara que le indique a tus usuarios a simple vista qué versión de la app están descargando y ejecutando. No tiene ningún otro propósito más que el de ser mostrado, así que no tiene otra restricción.</p>
</li>
</ul>
<p>Para modificarlos es necesario acceder al archivo <code>AndroidManifest.xml</code>. En Visual Studio o Xamarin Studio te podrás beneficiar de contar con un editor gráfico:</p>
<img src="https://thatcsharpguy.github.io/postimages/nugets/versioning/androidmanifest.jpg" title="AndroidManifest GUI editor" />
<h2 id="ios">iOS</h2>
<p>Para iOS la cosa no cambia mucho, igualmente existen dos valores con las mismas características (uno público y el otro privado) pero con distinto nombre:</p>
<ul>
<li><p><code>CFBundleVersion</code> es el valor &quot;privado&quot;, cumple el mismo propósito que el <code>versionCode</code> de Android, pero el valor de este es una cadena. Usualmente son tres números enteros positivos separados por un punto, toma en cuenta que cada vez que cargues una nueva actualización de tu app a la tienda, el valor del nuevo paquete debe ser mayor al que ya existía. Por ejemplo, si tienes un paquete con un valor de <code>1.2.3</code> no podrás cargar uno con <code>1.2.2</code> pero si uno <code>1.3.0</code>.</p>
</li>
<li><p><code>CFBundleShortVersionString</code> es la versión que es pública para el usuario, en teoría es una versión corta de <code>CFBundleVersion</code> aunque la documentación indica que puede ser cualquier cadena con el mismo formato que la anterior. Toma en cuenta que nuevamente, este valor debe ser algo que el usuario pueda entender fácilmente, pues serán ellos quienes lo verán más.</p>
</li>
</ul>
<p>Estos valores se almacenan en el archivo Info.plist, para el cual también tenemos disponible un editor gráfico:</p>
<img src="https://thatcsharpguy.github.io/postimages/nugets/versioning/infoplist.jpg" title="Info.plist GUI editor" />
<h2 id="version-tracking-plugin">Version Tracking Plugin</h2>
<p>Este pequeño paquetito de NuGet nos ayuda a acceder programáticamente a estos dos números directamente desde nuestro proyecto de Forms.</p>
<p>Con el <em>Version Tracking Plugin</em> tenemos acceso al historial de instalaciones y actualizaciones de nuestra app en el dispositivo del usuario. Es simple de usar, una vez instalados los paquetes en los tres proyectos tenemos que inicializarlo en el método <code>OnCreate</code> de la <code>MainActivity</code> y en el método <code>FinishedLaunching</code> del <code>AppDelegate</code>, bastará con llamar al siguiente método:</p>
<pre><code class="language-csharp">CrossVersionTracking.Current.Track();
</code></pre>
<p>Una vez hecho esto, a través de la propiedad <code>CrossVersionTracking.Current</code> tendremos acceso a todas sus propiedades:</p>
<h3 id="la-primera-vez">La primera vez</h3>
<p>Saber si es la primera vez que el usuario abre nuestra app con <code>IsFirstLaunchEver</code> nos puede ayudar para darle la bienvenida, saber si es la primera vez que está ejecutando una actualización con <code>IsFirstLaunchForVersion</code> nos puede ayudar para mostrarle las nuevas características añadidas en la app. Y saber si es la primera vez que está ejecutando una nueva compilación con <code>IsFirstLaunchForBuild</code> puede ayudarnos con los <em>analytics</em> de nuestra app.</p>
<h3 id="trabajando-con-versiones-y-builds-especificas">Trabajando con versiones y <em>builds</em> específicas</h3>
<p>Muchas veces no nos bastará con saber si es la primera vez que una versión se está ejecutando, también debemos saber exactamente cuál es la versión, para eso podemos usar la propiedad <code>CurrentVersion</code> o si por alguna razón queremos conocer la versión que estaba previamente instalada también podemos usar <code>PreviousVersion</code> y para ir aún más atrás en la historia podemos usar <code>FirstInstalledVersion</code> y si por alguna razón queremos obtener más información, podemos usar <code>VersionHistory</code> para acceder a un historial completo de las versiones que se han instalado en el dispositivo. Para acceder a las <em>builds</em> tenemos un conjunto de propiedades similares.</p>
<h3 id="eventos">Eventos</h3>
<p>Con este <em>plugin</em> también podemos establecer eventos que se ejecuten cuando una versión o <em>build</em> es ejecutada por primera vez. Podemos usar <code>OnFirstLaunchOfBuild</code> y <code>OnFirstLaunchOfVersion</code> para este propósito, aunque en mi opinión, estos no son tan útiles.</p>
<h2 id="un-ejemplo">Un Ejemplo</h2>
<p>He montado un ejemplo sencillo, que puedes obtener en GitHub, con unas cuantas <code>Labels</code> y un par de <code>ListView</code> para mostrar los datos que se pueden recuperar con este NuGet:</p>
<h4 id="primera-version">Primera versión</h4>
<p>Tenemos la primera versión de la app, con los siguientes valores en el nombre de la versión y la <em>build</em>:</p>
<div class="pure-g">
    <div class="pure-u-1-2">
```xml  
<!-- Android -->
android:versionCode="1" 
android:versionName="1.0"  
 
 
```  
	</div>
    <div class="pure-u-1-2">
```xml  
<!-- iOS -->
<key>CFBundleShortVersionString</key>
<string>1.0</string>
<key>CFBundleVersion</key>
<string>1.0</string>
```  
	</div>
</div>
<img src="https://thatcsharpguy.github.io/postimages/nugets/versioning/one.jpg" title="Version one" />
<h4 id="cambio-en-el-build">Cambio en el <em>build</em></h4>
<div class="pure-g">
    <div class="pure-u-1-2">
```xml  
<!-- Android -->
android:versionCode="2" 
android:versionName="1.0"  
 
 
```  
	</div>
    <div class="pure-u-1-2">
```xml  
<!-- iOS -->
<key>CFBundleShortVersionString</key>
<string>1.0</string>
<key>CFBundleVersion</key>
<string>1.1</string>
```  
	</div>
</div>
<img src="https://thatcsharpguy.github.io/postimages/nugets/versioning/two.jpg" title="Build bump" />
<h4 id="cambio-en-la-version">Cambio en la versión</h4>
<div class="pure-g">
    <div class="pure-u-1-2">
```xml  
<!-- Android -->
android:versionCode="2" 
android:versionName="1.2"  
 
 
```  
	</div>
    <div class="pure-u-1-2">
```xml  
<!-- iOS -->
<key>CFBundleShortVersionString</key>
<string>1.2</string>
<key>CFBundleVersion</key>
<string>1.1</string>
```  
	</div>
</div>
<img src="https://thatcsharpguy.github.io/postimages/nugets/versioning/three.jpg" title="Version bump" />
<h4 id="cambio-en-la-version-y-build">Cambio en la versión y <em>build</em></h4>
<div class="pure-g">
    <div class="pure-u-1-2">
```xml  
<!-- Android -->
android:versionCode="2" 
android:versionName="2.0"  
 
 
```  
	</div>
    <div class="pure-u-1-2">
```xml  
<!-- iOS -->
<key>CFBundleShortVersionString</key>
<string>2.0</string>
<key>CFBundleVersion</key>
<string>2.0</string>
```  
	</div>
</div>
<img src="https://thatcsharpguy.github.io/postimages/nugets/versioning/four.jpg" title="Bumped both" />
<h4 id="cambio-en-la-version-y-build-1">Cambio en la versión y <em>build</em></h4>
<div class="pure-g">
    <div class="pure-u-1-2">
```xml  
<!-- Android -->
android:versionCode="3" 
android:versionName="3.0"  
 
 
```  
	</div>
    <div class="pure-u-1-2">
```xml  
<!-- iOS -->
<key>CFBundleShortVersionString</key>
<string>3.0</string>
<key>CFBundleVersion</key>
<string>3.0</string>
```  
	</div>
</div>
<img src="https://thatcsharpguy.github.io/postimages/nugets/versioning/five.jpg" title="Bumped both" />
<h4 id="si-el-usuario-borra-la-app">Si el usuario borra la app...</h4>
<p>Desde luego, toda esta información se pierde si el usuario borra la app. En este caso, el usuario borró y reinstaló la versión tres, y tras abrirla nuevamente, esta es la pantalla que aparece:</p>
<img src="https://thatcsharpguy.github.io/postimages/nugets/versioning/six.jpg" title="Fresh versioning" />
<h2 id="instalacion">Instalación</h2>
<p>Para instalarlo basta con instalar el <a href="https://www.nuget.org/packages/Plugin.VersionTracking/" target="_blank">paquete de NuGet</a> Plugin.VersionTracking.</p>
<pre><code>PM&gt; Install-Package Plugin.VersionTracking
</code></pre>
<p>Recuerda que debes instalarlo tanto en los proyectos cliente como en el proyecto de Forms.</p>
<p>Si deseas ver el código que le da a este <em>plugin</em> su poder, puedes visitar el <a href="https://github.com/colbylwilliams/VersionTrackingPlugin" target="_blank">proyecto en GitHub</a>, para que colabores con el creador si es que le encuentras algún error.</p>


    </div>
</article>

                    </section>
                    <section class="sidebar">
                        <div class="theme-toggle">
  <input type="checkbox" id="theme-switch"/>
  <label for="theme-switch">
      <div class="toggle"></div>
      <div class="names">
          <p class="light">Light</p>
          <p class="dark">Dark</p>
      </div>
  </label>
</div>
  


<script>
    (function() {
      var sw = document.getElementById('theme-switch');
      var html = document.getElementsByTagName('html')[0];
      var nightModeOption = ('auto' || 'auto').toLowerCase();
      var storage = nightModeOption === 'manual'
          ? localStorage
          : sessionStorage;
      var themeData = loadThemeData();
  
      function saveThemeData(data) {
        storage.setItem('theme', JSON.stringify(data));
      }
  
      function loadThemeData() {
        var data = storage.getItem('theme');
        try {
          data = JSON.parse(data ? data : '');
        } catch(e) {
          data = { nightShift: undefined, autoToggleAt: 0 };
          saveThemeData(data);
        }
        return data;
      }
  
      function handleThemeToggle(nightShift) {
        themeData.nightShift = nightShift;
        saveThemeData(themeData);
        html.dataset.theme = nightShift ? 'dark' : 'light';
        setTimeout(function() {
          sw.checked = nightShift ? true : false;
        }, 50);
      }
  
      function autoThemeToggle() {
        // Next time point of theme toggle
        var now = new Date();
        var toggleAt = new Date();
        var hours = now.getHours();
        var nightShift = hours >= 19 || hours <=7;
  
        if (nightShift) {
          if (hours > 7) {
            toggleAt.setDate(toggleAt.getDate() + 1);
          }
          toggleAt.setHours(7);
        } else {
          toggleAt.setHours(19);
        }
  
        toggleAt.setMinutes(0);
        toggleAt.setSeconds(0);
        toggleAt.setMilliseconds(0)
  
        var delay = toggleAt.getTime() - now.getTime();
  
        // auto toggle theme mode
        setTimeout(function() {
          handleThemeToggle(!nightShift);
        }, delay);
  
        return {
          nightShift: nightShift,
          toggleAt: toggleAt.getTime()
        };
      }
  
      // Listen the theme toggle event
      sw.addEventListener('change', function(event) {
        handleThemeToggle(event.target.checked);
      });
  
      if (nightModeOption == 'auto') {
        var data = autoThemeToggle();
  
        // Toggle theme by local setting
        if (data.toggleAt > themeData.autoToggleAt) {
          themeData.autoToggleAt = data.toggleAt;
          handleThemeToggle(data.nightShift);
        } else {
          handleThemeToggle(themeData.nightShift);
        }
      } else if (nightModeOption == 'manual') {
        handleThemeToggle(themeData.nightShift);
      } else {
        var nightShift = themeData.nightShift;
        if (nightShift === undefined) {
          nightShift = nightModeOption === 'on';
        }
        handleThemeToggle(nightShift);
      }
    })();
  </script>
                        <div class="post-menu">
                            <div class="post-menu-title">Sígueme en</div>
                            <div class="common-list">
                                <ul>
                                    
                                    <li>
                                        <a href="https://github.com/fferegrino">GitHub<span><i class="fab fa-github"></i></span></a>
                                    </li>
                                    
                                    <li>
                                        <a href="https://twitter.com/io_exception">Twitter<span><i class="fab fa-twitter"></i></span></a>
                                    </li>
                                    
                                    <li>
                                        <a href="https://youtube.com/thatcsharpguy">YouTube<span><i class="fab fa-youtube"></i></span></a>
                                    </li>
                                    
                                    <li>
                                        <a href="https://tcsg.dev/discord">Discord<span><i class="fab fa-discord"></i></span></a>
                                    </li>
                                    
                                </ul>
                            </div>
                        </div>
                        
 <style type="text/css" media="screen">
    .post-menu ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }
</style>
<div class="post-menu toc">
    <div class="post-menu-title">TOC</div>
    <div class="post-menu-content"></div>
</div>
<script>
    function generateContent() {
        var menu = document.querySelector(".post-menu.toc");
        console.log(menu);
        var menuContent = menu.querySelector(".post-menu-content");
        var headings = document.querySelector(".post-content").querySelectorAll("h2, h3, h4, h5, h6");
        // Hide menu when no headings
        if (headings.length === 0) {
            return menu.style.display = "none";
        }
        // Generate post menu
        var menuHTML = '';
        for (var i = 0; i < headings.length; i++) {
            var h = headings[i];
            menuHTML += ('<li class="h-' + h.tagName.toLowerCase() + '">' + '<a href="#' + h.getAttribute('id') + '">' + h.textContent + '</a></li>');
        }
        menuContent.innerHTML = '<ul>' + menuHTML + '</ul>';
        // The header element
        var header = document.querySelector('header.site-header');
        function doMenuCollapse(index, over_items) {
            var items = menuContent.firstChild.children;
            if (over_items == undefined) {
                over_items = 20;
            }
            if (items.length<over_items) {
        return;
      }

      var activeItem = items[index];
      var beginItem = activeItem
      var endItem = activeItem
      var beginIndex = index;
      var endIndex = index + 1;
      while (beginIndex >= 0 && ! items[beginIndex].classList.contains('h-h2')) {
                beginIndex -= 1;
            }
            while (endIndex < items.length && ! items[endIndex].classList.contains('h-h2')) {
                endIndex += 1;
            }
            for (var i = 0; i < beginIndex; i++) {
                item = items[i]
                if (!item.classList.contains('h-h2')) {
                    item.style.display = 'none';
                }
            }
            for (var i = beginIndex + 1; i < endIndex; i++) {
                item = items[i]
                // if (!item.classList.contains('h-h2')) {
                item.style.display = '';
                // }
            }
            for (var i = endIndex; i < items.length; i++) {
                item = items[i]
                if (!item.classList.contains('h-h2')) {
                    item.style.display = 'none';
                }
            }
        }
        // Init menu collapsed
        doMenuCollapse(-1);
        // Active the menu item
        window.addEventListener('scroll', function (event) {
            var lastActive = menuContent.querySelector('.active');
            var changed = true;
            var activeIndex = -1;
            for (var i = headings.length - 1; i >= 0; i--) {
                var h = headings[i];
                var headingRect = h.getBoundingClientRect();
                var headerRect = header.getBoundingClientRect();
                var headerTop = Math.floor(headerRect.top);
                var headerHeight = Math.floor(headerRect.height);
                var headerHeight = headerTop + headerHeight + 20;
                if (headingRect.top <= headerHeight) {
                    var id = 'h-' + h.getAttribute('id');
                    var a = menuContent.querySelector('a[href="#' + id + '"]');
                    var curActive = a.parentNode;
                    if (curActive) {
                        curActive.classList.add('active');
                        activeIndex = i;
                    }
                    if (lastActive == curActive) {
                        changed = false;
                    }
                    break;
                }
            }
            if (changed) {
                if (lastActive) {
                    lastActive.classList.remove('active');
                }
                doMenuCollapse(activeIndex);
            }
            event.preventDefault();
        });
    }
    document.addEventListener("DOMContentLoaded", function() {
        generateContent()
    });
</script>

                    </section>
                </div>
            </div>
        </div>
        <footer class="site-footer h-card">
   <data class="u-url" href="/"></data>
 
   <div class="wrapper">
     <div class="site-footer-inner">
       <div> </div>
       <div>Powered by <a title="Lockdonw in a simple, blog-aware, static site generator." href="https://github.com/lockdownblog/lockdown">Lockdown</a> &amp; <a title="Yat, yetanother theme." href="https://github.com/jeffreytse/jekyll-theme-yat">Yat Theme</a>.</div>
       <!-- <div class="footer-col rss-subscribe">Subscribe <a href="/feed.xml">via RSS</a></div> -->
     </div>
   </div>
 </footer>
    </body>
</html>